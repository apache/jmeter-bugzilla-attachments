--- AbstractTestElement.java.original	Wed May 30 12:33:29 2007
+++ AbstractTestElement.java	Wed May 30 12:36:55 2007
@@ -20,8 +20,8 @@
 
 import java.io.Serializable;
 import java.util.Collections;
-import java.util.HashMap;
-import java.util.HashSet;
+import java.util.LinkedHashMap;
+import java.util.LinkedHashSet;
 import java.util.Iterator;
 import java.util.Map;
 import java.util.Set;
@@ -47,7 +47,7 @@
 public abstract class AbstractTestElement implements TestElement, Serializable {
 	private static final Logger log = LoggingManager.getLoggerForClass();
 
-	private Map propMap = Collections.synchronizedMap(new HashMap());
+	private Map propMap = Collections.synchronizedMap(new LinkedHashMap());
 
 	private transient Set temporaryProperties;
 
@@ -214,10 +214,12 @@
 			clearTemporary(property);
 		}
 		JMeterProperty prop = getProperty(property.getName());
+        removeProperty(property.getName());
 
 		if (prop instanceof NullProperty || (prop instanceof StringProperty && prop.getStringValue().equals(""))) {
 			propMap.put(property.getName(), property);
 		} else {
+            propMap.put(property.getName(), prop);
 			prop.mergeIn(property);
 		}
 	}
@@ -342,7 +344,7 @@
 	 */
 	public void setTemporary(JMeterProperty property) {
 		if (temporaryProperties == null) {
-			temporaryProperties = new HashSet();
+			temporaryProperties = new LinkedHashSet();
 		}
 		temporaryProperties.add(property);
 		if (property instanceof MultiProperty) {
